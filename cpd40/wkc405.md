# Deploying Watson Knowledge Catalog 4.0.5

## Topics

- [ ] Deployment Planning
- [ ] Setup Bastion Host
- [ ] Registry Mirroring
- [ ] Configuring cluster pull images
- [ ] Node settings
- [ ] Project creation and NamespaceScope
- [ ] Custom Security Context Constraints
- [ ] Create IBM Operator Catalog source
- [ ] Installing IBM Cloud Pak foundation services
- [ ] Installing Cloud Pak for Data platform
- [ ] Installing Watson Knowledge Catalog
- [ ] WKC post-installation tasks
- [ ] Installing license server
- [ ] 

***
#### 1.0  Deployment planning
***

#### Requirements

- Sizing the Cluster
  https://app.ibmsalesconfigurator.com
  
- OpenShift 4.6.30+ or 4.8.x

- Cluster Compute Requirement
  - [ ] Minimum 3 compute nodes
  - [ ] Each node should be of minimum 16core, 64GB RAM and 200GB storage
  - [ ] Total Compute requirement will be calculated based on the number of services and user workload. IBM Team will help size the cluster compute requirements. 
  - [ ] Minimum Compute requirement for installation: 48 Core, 196 GB
  - [ ] OpenShift nodes should meet the configuration requirements for CPD services

- Cloud Pak for Data 4.0.5 Services
  - [ ] Cloud Pak Foundational Service
  - [ ] Cloud Pak for Data - Control Plane
  - [ ] Watson Knowledge Catalog and its bundle

- Networking Internet access to Mirror IBM image registries
  - [ ] docker.io/ibmcom
  - [ ] quay.io/opencloudio
  - [ ] cp.icr.io/cp 
  - [ ] icr.io/cpopen
  - [ ] https://github.com
  
- Networking Internet access to download IBM installer and cases:
  - [ ] https://github.com/IBM/cloud-pak-cli/releases/download
  - [ ] https://github.com/IBM/cloud-pak/raw/master/repo/case
- Storage
  - [ ] Persistent Storage 1 TB
  - [ ] Private Registry Storage 500 GB (example, Artifactory)
- License
  - [ ] IBM Cloud Pak for Data Standard/Enterprise license
  - [ ] Access to IBM Entitlement Key (myibm.ibm.com)
- User Permissions
  - [ ] OpenShift Administrator ( Cluster preparation )
  - [ ] Cloud Pak for Data administrator ( WKC Installation )
  - [ ] Read/Write permission to Artifactory Registry 
- Bastion Host
   - [ ] RHEL 8x, 500GB disk
   - [ ] Skopeo 1.x
   - [ ] python 3.x
   - [ ] pyyaml, jq

***
#### 2.0 Bastion Host setup
***

***
#### 3.0 OpenShift cluster Setup
***

* [ ] OpenShift Version
```
OpenShift version 4.6.30+ or 4.8.x are supported versions


oc get clusterversion
NAME      VERSION   AVAILABLE   PROGRESSING   SINCE   STATUS
version   4.8.26    True        False         13d     Cluster version is 4.8.26


If the cluster is in olderversion
```


* [ ] [Setup Persistent Storage and Storage Classes](https://www.ibm.com/docs/en/cloud-paks/cp-data/4.0?topic=tasks-setting-up-shared-persistent-storage)


Red Hat OpenShift Container Storage, IBM SpectrumÂ® Scale Container Native, Portworx and NFS are supported storage types

```
# Sample output
oc get storageclass

NAME                            PROVISIONER                             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
localblock-sc                   kubernetes.io/no-provisioner            Delete          WaitForFirstConsumer   false                  25d
managed-nfs-storage (default)   nfs-provisioner/nfs                     Delete          Immediate              false                  25d
ocs-storagecluster-ceph-rbd     openshift-storage.rbd.csi.ceph.com      Delete          Immediate              true                   25d
ocs-storagecluster-ceph-rgw     openshift-storage.ceph.rook.io/bucket   Delete          Immediate              false                  25d
ocs-storagecluster-cephfs       openshift-storage.cephfs.csi.ceph.com   Delete          Immediate              true                   25d
openshift-storage.noobaa.io     openshift-storage.noobaa.io/obc         Delete          Immediate              false                  25d
```

***
#### 4.0 Project 
***

* Create project namespaces for Cloud Pak for Data Installations
```
oc project cpd
oc project ibm-common-services

* OperatorGroup

```
cat <<EOF |oc apply -f -
apiVersion: operators.coreos.com/v1alpha2
kind: OperatorGroup
metadata:
  name: operatorgroup
  namespace: ibm-common-services
spec:
  targetNamespaces:
  - ibm-common-services
EOF


```


